plugins {
  id 'java'
  id 'application'
  id 'com.github.johnrengelman.shadow' version '5.2.0'
}

mainClassName = 'main.java.bot.driver.Monitor'

version = '1.0'

sourceCompatibility = 1.8

repositories {
  jcenter()
}

task stage(dependsOn: ['build', 'clean'])
build.mustRunAfter clean

dependencies {
  implementation "ch.qos.logback:logback-classic:1.2.3"   
  implementation 'net.dv8tion:JDA:4.2.0_200'
  implementation 'com.sedmelluq:lavaplayer:1.3.50'
  implementation group: 'com.google.apis', name: 'google-api-services-youtube', version: 'v3-rev222-1.25.0'
}

task fatJar(type: Jar) {
     manifest {
          attributes 'Implementation-Version': version
          attributes 'Main-Class': mainClassName
     }
     baseName = project.name + '-withDependencies'
     from {
          configurations
               .compile
               .collect { it.isDirectory() ? it : zipTree(it) }
     }
     with jar
}

compileJava.options.encoding = 'UTF-8'

assemble.dependsOn fatJar;